name: Deploy UI Project to Firebase Hosting

on:
  push:
    branches: [ main ]
  workflow_dispatch:

permissions:
  contents: read
  # GitHub Pages ê´€ë ¨ ê¶Œí•œì€ ì´ì œ í•„ìš” ì—†ìŠµë‹ˆë‹¤.
  # pages: write
  # id-token: write

concurrency:
  group: deployment-${{ github.ref }}
  cancel-in-progress: false

jobs:
  build_and_deploy: # deploy job ëŒ€ì‹  í•˜ë‚˜ì˜ jobìœ¼ë¡œ í†µí•©
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4
        
      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      
      - name: Install UI Dependencies
        working-directory: ./stock-platform-ui-new
        run: npm ci
        
      - name: Build UI Project
        working-directory: ./stock-platform-ui-new
        run: npm run build
        env:
          CI: false
          
      # ------------------------------------------------------------------
      # ğŸ”¥ FIREBASE HOSTING ë°°í¬ ìŠ¤í… ì¶”ê°€ (í•µì‹¬)
      # ------------------------------------------------------------------
      - name: Deploy to Firebase Hosting
        uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          # Firebase í”„ë¡œì íŠ¸ ID (ì½˜ì†”ì—ì„œ í™•ì¸)
          projectId: stockplatform-fe563 
          # Firebase ë°°í¬ì— í•„ìš”í•œ ì„œë¹„ìŠ¤ ê³„ì • Secretì„ ì‚¬ìš©
          repoToken: '${{ secrets.GITHUB_TOKEN }}' 
          firebaseServiceAccount: '${{ secrets.FIREBASE_SERVICE_ACCOUNT }}' # (ë§¤ìš° ì¤‘ìš”!)
          # ë¹Œë“œëœ íŒŒì¼ì´ ìˆëŠ” ë””ë ‰í† ë¦¬ë¥¼ ì§€ì •í•©ë‹ˆë‹¤. (firebase.jsonì—ì„œ ì„¤ì •í–ˆìœ¼ë¯€ë¡œ ìƒëµ ê°€ëŠ¥í•˜ë‚˜, ëª…ì‹œì ìœ¼ë¡œ ì§€ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.)
          # public: stock-platform-ui-new/build 
          # í˜„ì¬ëŠ” firebase.jsonì´ ë£¨íŠ¸ì— ìˆìœ¼ë¯€ë¡œ entryPointëŠ” ìƒëµí•©ë‹ˆë‹¤.